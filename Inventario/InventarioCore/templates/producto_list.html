{% extends 'base.html' %}

{% block title %}Productos{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">Productos</h2>
  <div>
    <a class="btn btn-success" href="{% url 'producto-create' %}">Crear producto</a>
    <a class="btn btn-outline-primary" href="{% url 'export-productos-csv' %}">Exportar CSV</a>
  </div>
</div>

<form method="get" class="row g-2 mb-3">
  <div class="col-auto">
    <input name="q" value="{{ request.GET.q }}" class="form-control" placeholder="Buscar...">
  </div>
  <div class="col-auto">
    <button class="btn btn-primary">Buscar</button>
  </div>
</form>

<div class="table-responsive">
  <table class="table table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Categoría</th>
        <th>Cantidad</th>
        <th>Precio</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for producto in object_list %}
      <tr>
        <td>{{ producto.id }}</td>
        <td><a href="{% url 'producto-detail' producto.pk %}">{{ producto.nombre }}</a></td>
        <td>{{ producto.categoria.nombre }}</td>
        <td>{{ producto.cantidad }}</td>
        <td>{{ producto.precio_unitario }}</td>
        <td>
          <a class="btn btn-sm btn-outline-secondary" href="{% url 'producto-update' producto.pk %}">Editar</a>
          <a class="btn btn-sm btn-danger" href="{% url 'producto-delete' producto.pk %}">Eliminar</a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="6">No hay productos.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% if is_paginated %}
  <nav aria-label="Page navigation">
    <ul class="pagination">
      {% if page_obj.has_previous %}
        <li class="page-item"><a class="page-link" href="?q={{ request.GET.q }}&page={{ page_obj.previous_page_number }}">Anterior</a></li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Anterior</span></li>
      {% endif %}
      <li class="page-item disabled"><span class="page-link">Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span></li>
      {% if page_obj.has_next %}
        <li class="page-item"><a class="page-link" href="?q={{ request.GET.q }}&page={{ page_obj.next_page_number }}">Siguiente</a></li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Siguiente</span></li>
      {% endif %}
    </ul>
  </nav>
{% endif %}
{% endblock %}
